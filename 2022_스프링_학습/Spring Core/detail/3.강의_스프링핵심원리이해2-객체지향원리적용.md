# μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄2 - κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

# 

> π’΅ μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ ν™•μ¥ν•΄λ³΄μ!



μ°Έκ³ : μ• μμΌμ†ν”„νΈμ›¨μ–΄κ°λ°μ„ μ–Έ [https://agilemanifesto.org/iso/ko/manifesto.html](https://agilemanifesto.org/iso/ko/manifesto.html)

**κ³ μ • ν• μΈ μ •μ±… β†’ μ •λ¥  ν• μΈ μ •μ±…**

ν• μΈ μ •μ±…μ„ μ •λ¥  ν•™μΈ μ •μ±…μΌλ΅ λ³€κ²½ν•λ ¤λ©΄, `OrderserviceImpl`μ μ½”λ“λ¥Ό μμ •ν•΄μ•Ό ν•λ‹¤.

**λ¬Έμ μ **

OCP, DIP κ°™μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ¤€μν•μ§€ λ»ν•¨.

DIP : μ¶”μƒ(μΈν„°νμ΄μ¤)λΏλ§ μ•„λ‹λΌ κµ¬μ²΄(κµ¬ν„) ν΄λμ¤μ—λ„ μμ΅΄ν•κ³  μμ

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled.png)

μ„μ κ·Έλ¦Όμ²λΌ μΈν„°νμ΄μ¤ λ§μ„ μμ΅΄ν•μ—¬ DIPλ¥Ό μ¤€μν•κ³ μ ν–μΌλ‚,

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%201.png)

`FixDiscountPolicy` λλ” `RateDiscountPolicy`λ¥Ό ν•¨κ» μμ΅΄ν•κ³  μλ‹¤. μ¶”μƒ λ° κµ¬μ²΄μ— λ¨λ‘ μμ΅΄ν•μ€λ‹¤.

**β‡’ DIP μ„λ°**

**μ •μ±…λ³€κ²½**

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%202.png)

`FixDiscountPolicy`μ—μ„ `RateDiscountPolicy`λ΅ λ³€κ²½ν•λ©΄, `OrderServiceImpl`λ„ λ³€κ²½ν•΄μ•Όν•λ‹¤.

μ¦‰, κΈ°λ¥μ„ ν™•μ¥ν•΄μ„ λ³€κ²½μ„ ν•λ©΄, ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μν–¥μ„ μ¤€λ‹¤.

**β‡’ OCP μ„λ°**

**μ–΄λ–»κ² λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μμ„κΉ?**

DIP μ„λ° β†’ μ¶”μƒμ—λ§ μμ΅΄ν•λ„λ΅ λ³€κ²½(μΈν„°νμ΄μ¤μ—λ§ μμ΅΄)

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%203.png)

λ³€κ²½ν•μ€μ§€λ§ κµ¬μ²΄κ°€ μ΅΄μ¬ν•μ§€ μ•μ•„ `discountPolicy`μ λ©”μ„λ“λ¥Ό νΈμ¶ν•λ” κ³Όμ •μ—μ„ NPEκ°€ λ°μƒν•λ‹¤.

**ν•΄κ²°λ°©μ•**

λ„κµ°κ°€ ν΄λΌμ΄μ–ΈνΈμΈ β€`OrderserviceImpl`β€™μ— β€`DiscountPolicy`'μ κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μ£Όμ…ν•΄μ£Όλ©΄ λλ‹¤.

---

## **κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬**

λ„κµ°κ°€μ ν΄λΌμ΄μ–ΈνΈμ— ν•΄λ‹Ήν•λ” λ€μƒμ€ μ–΄λ– ν• μΈν„°νμ΄μ¤μ μ‘μ—…λ§μ„ νΈμ¶ν•λ‹¤. μ¦‰ μμ‹λ΅ `MemberServiceImpl` μ΄ `MemberRepository` λ¥Ό ν†µν•΄μ„, Memberλ¥Ό μ €μ¥ν•κ±°λ‚ μ΅°νν•λ©΄ λλ‹¤. κ·Έ  

`MemberRepository`κ°€ `MemoryMemberRepository` μΈμ§€, `DBMemberRepository` μΈμ§€μ— λ€ν• κµ¬ν„μ²΄λ¥Ό μ• ν•„μ”λ” μ—†λ‹¤. μ΄λ¥Ό **κ΄€μ‹¬μ‚¬ λ¶„λ¦¬**λΌκ³  ν•λ‹¤. κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•κΈ° μ„ν•΄μ„λ” μ‹¤μ  κµ¬ν„μ²΄λ¥Ό μ£Όμ…ν•΄μ¤„ μ μλ” μ¦‰, `MemberserviceImpl` μ΄ `MemberRepository`λ¥Ό νΈμ¶ν•μ€μ„ λ•, μ–΄λ– ν• Repositoryλ¥Ό μ‚¬μ©ν•΄μ¤„ κ²ƒ μΈμ§€μ— λ€ν• λ€μƒμ„ μ£Όμ…ν•΄μ¤μ•Ό ν•λ‹¤.

μμ΅΄κ΄€κ³„μ— λ€ν• μ£Όμ…μ„ μ™Έλ¶€(`AppConfig`)μ—μ„ μν–‰ν•μ—¬, κ΄€μ‹¬μ‚¬λ¥Ό λ…ν™•ν λ¶„λ¦¬ν•΄μ¤€λ‹¤.

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%204.png)

κ°μ²΄μ μƒμ„±κ³Ό μ—°κ²°μ€ `AppConfig` κ°€ λ‹΄λ‹Ήν•λ‹¤.

κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν• κ³Ό μ‹¤ν–‰ν•λ” μ—­ν• μ΄ λ…ν™•ν λ¶„λ¦¬λμ—λ‹¤.

**νμ› κ°μ²΄ μΈμ¤ν„΄μ¤ λ‹¤μ΄μ–΄κ·Έλ¨**

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%205.png)

`appConfig` κ°μ²΄λ” `memoryMemberRepository` κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ·Έ μ°Έμ΅°κ°’μ„ `memberServiceImpl` μ„ μƒμ„±ν•λ©΄μ„ μƒμ„±μλ΅ μ „λ‹¬ν•λ‹¤.

ν΄λΌμ΄μ–ΈνΈμΈ `memberServiceImpl` μ…μ¥μ—μ„ λ³΄λ©΄ μμ΅΄κ΄€κ³„λ¥Ό λ§μΉ μ™Έλ¶€μ—μ„ μ£Όμ…ν•΄μ£Όλ” κ²ƒ κ°™λ‹¤κ³  ν•΄μ„ DI(Depedency Injection) μ°λ¦¬λ§λ΅ **μμ΅΄κ΄€κ³„ μ£Όμ…** λλ” **μμ΅΄μ„± μ£Όμ…**μ΄λΌκ³  ν•λ‹¤.

---

### AppConfig λ¦¬ν©ν„°λ§

ν„μ¬ AppConfigλ¥Ό λ³΄λ©΄ β€μ¤‘λ³µβ€™μ΄ μκ³ , **μ—­ν• **μ— λ”°λ¥Έ **κµ¬ν„**μ΄ μ μ•λ³΄μΈλ‹¤.

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%206.png)

---

### μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

AppConfigμ λ“±μ¥μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν¬κ² μ‚¬μ© μμ—­κ³Ό, κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κµ¬μ„±ν•λ” μμ—­μΌλ΅ λ¶„λ¦¬λμ—λ‹¤.

**μ‚¬μ©, κµ¬μ„±μ λ¶„λ¦¬**

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%207.png)

**ν• μΈ μ •μ±…μ λ³€κ²½**

![Untitled](../img/μ¤ν”„λ§ν•µμ‹¬μ›λ¦¬μ΄ν•΄2-κ°μ²΄μ§€ν–¥μ›λ¦¬μ μ©/Untitled%208.png)

κµ¬μ„± μμ—­λ§ λ³€κ²½ν•μ—¬ μ‹¤ μ‚¬μ© μμ—­μ λ‚΄μ©μ΄ λ³€κ²½λμ§€ μ•μ„ μƒνƒλ΅ ν• μΈ μ •μ±…μ„ λ³€κ²½ν•  μ μλ‹¤.

---

## μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™μ μ μ©

μ„μ μμ μ—μ„λ” SRP, DIP, OCPλ¥Ό μ μ©

SRP λ‹¨μΌ μ±…μ„ μ›μΉ™

ν• ν΄λμ¤λ” ν•λ‚μ μ±…μ„λ§ κ°€μ Έμ•Ό ν•λ‹¤.

ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ§μ ‘ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μμ—μ β†’ SRP μ„λ°

SRP λ‹¨μΌ μ±…μ„ μ›μΉ™μ„ λ”°λ¥΄κΈ° μ„ν•΄ κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•¨

κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ±…μ„μ„ AppConfigκ°€ λ‹΄λ‹Ήν•λ„λ΅ κ΄€μ‹¬μ‚¬κ°€ λ¶„λ¦¬λ¨

ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ‹¤ν–‰ν•λ” μ±…μ„λ§ λ‹΄λ‹Ήν•κ² λ¨

DIP μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™

ν”„λ΅κ·Έλλ¨Έλ” β€μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤.β€ μμ΅΄μ„± μ£Όμ…μ€ μ΄ μ›μΉ™μ„ λ”°λ¥΄λ” λ°©λ²• μ¤‘ ν•λ‚λ‹¤.

μƒλ΅μ΄ ν• μΈ μ •μ±…(κµ¬ν„)μ„ κ°λ°ν•κ³ , μ΄λ¥Ό μ‚¬μ©ν•λ ¤κ³  ν•λ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν–λ‹¤. μ™λƒν•λ©΄ κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” DIPλ¥Ό μ§€ν‚¤λ©° `DiscountPolicy` μ¶”μƒν™” μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ” κ²ƒ κ°™μ•μ§€λ§, `FixDiscountPolicy` μ— ν•΄λ‹Ήν•λ” κµ¬ν„μ²΄λ„ ν•¨κ» μμ΅΄ν–κΈ° λ•λ¬Έμ΄λ‹¤.

ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ `DiscountPolicy` μ¶”μƒν™” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤.

ν•μ§€λ§ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μΈν„°νμ΄μ¤λ§μΌλ΅λ” μ•„λ¬΄κ²ƒλ„ μ‹¤ν–‰ν•  μ μ—†λ‹¤.

`AppConfig` κ°€ `FixDiscountPolicy` κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ€μ‹  μƒμ„±ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν•μ€λ‹¤. μ΄λ΅μ¨ DIP μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ λ¬Έμ λ„ ν•΄κ²°λμ—λ‹¤.

OCP κ°λ°© νμ‡„ μ›μΉ™

μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤

λ‹¤ν•μ„±μ„ μ‚¬μ©ν•κ³  ν΄λΌμ΄μ–ΈνΈκ°€ DIPλ¥Ό μ§€ν‚¤λ©΄ OCPλ¥Ό μ§€ν‚¬ μ μλ” κ°€λ¥μ„±μ΄ μ—΄λ¦Ό

μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­μΌλ΅ λ‚λ”

`AppConfig`κ°€ μμ΅΄κ΄€κ³„λ¥Ό `FixDiscountPolicy` μ—μ„ `RateDiscountPolicy` λ΅ λ³€κ²½ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μ£Όμ…ν•λ―€λ΅ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ³€κ²½ν•μ§€ μ•μ•„λ„ λ¨

μ†ν”„νΈμ›¨μ–΄ μ”μ†λ¥Ό **μƒλ΅­κ²** **ν™•μ¥**ν•΄λ„ μ‚¬μ© μμ—­μ **λ³€κ²½μ€ λ‹«ν€** μλ‹¤.

---

## IoC, DI, κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„

**μ μ–΄μ μ—­μ „ IoC(Inversion of Control)**

κΈ°μ΅΄ ν”„λ΅κ·Έλ¨μ€ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ—μ„ ν”„λ΅κ·Έλ¨μ νλ¦„μ„ μ§μ ‘ μ μ–΄ν•μ€λ‹¤. ν•μ§€λ§ AppConfigλ¥Ό μ‚¬μ©ν•λ©΄μ„ AppConfigκ°€ ν”„λ΅κ·Έλ¨μ νλ¦„μ„ μ μ–΄ν•κ³  μ‹¤μ  ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μ‹¤ν–‰μ μ—­ν• λ§μ„ μν–‰ν•κ² λμ—λ‹¤. IoCμ—μ„ λ§ν•λ” Control(μ μ–΄)μ€ ν”„λ΅κ·Έλ¨μ νλ¦„μ„ μ μ–΄ν•¨μ„ μλ―Έν•λ‹¤. μ¦‰ λ‹¤μ‹ λ§ν•΄, κΈ°μ΅΄μ— μµμ™ν• νλ¦„μΈ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ—μ„ μΈν„°νμ΄μ¤μ κµ¬ν„μ²΄λ¥Ό μ§μ ‘ νΈμ¶ν•λ” ν•νƒκ°€ μ•„λ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μ–΄λ– ν• κµ¬ν„μ²΄λ¥Ό μ‚¬μ©ν• μ§€λ” μ•μ§€ λ»ν•κ³  μΈν„°νμ΄μ¤λ§μ„ νΈμ¶ν•κ² λλ‹¤. ν”„λ΅κ·Έλ¨μ νλ¦„μ΄ μ–΄λ–»κ² νλ¬κ°€λ”μ§€ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ—μ„λ” μ• μκ°€ μ—†λ‹¤. μ™λƒν•λ©΄ AppConfigκ°€ ν”„λ΅κ·Έλ¨μ νλ¦„μ„ μ μ–΄ν•κΈ° λ•λ¬Έμ—.. μ΄λ¥Ό μ μ–΄μ μ—­μ „μ΄λΌκ³  ν•λ‹¤.

**μμ΅΄κ΄€κ³„ μ£Όμ… DI(Dependency Injection)**

OrderServiceImpl μ€ DiscountPolicy μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ‹¤. μ‹¤μ  μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ μ‚¬μ©λ μ§€λ” λ¨λ¥Έλ‹¤.

**μ •μ μΈ ν΄λμ¤ μμ΅΄κ΄€κ³„**

ν΄λμ¤κ°€ μ‚¬μ©ν•λ” import μ½”λ“λ§ λ³΄κ³  μμ΅΄κ΄€κ³„λ¥Ό μ‰½κ² νλ‹¨ν•  μ μλ‹¤. μ •μ μΈ μμ΅΄κ΄€κ³„λ” μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•μ§€ μ•μ•„λ„ λ¶„μ„ν•  μ μλ‹¤.

**λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄ κ΄€κ³„**

μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹μ μ— μ‹¤μ  μƒμ„±λ κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°κ°€ μ—°κ²°λ μμ΅΄ κ΄€κ³„μ΄λ‹¤.

**μ¤ν”„λ§ μ»¨ν…μ΄λ„**

- `ApplicationContext` λ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„λΌ ν•λ‹¤.
- κΈ°μ΅΄ κ°λ°μκ°€ `AppConfig` λ¥Ό μ‚¬μ©ν•μ—¬ μ§μ ‘ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  DIλ¥Ό ν–μ§€λ§, μ΄μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„λ¥Ό ν†µν•΄μ„ μ‚¬μ©ν•λ‹¤.
- μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” `@Configuration` μ΄ λ¶™μ€ `AppConfig` λ¥Ό μ„¤μ • μ •λ³΄λ΅ μ‚¬μ©ν•λ‹¤. μ—¬κΈ°μ„ `@Bean` μ΄λΌ μ ν λ©”μ„λ“λ¥Ό λ¨λ‘ νΈμ¶ν•λ‹¤. μ΄λ ‡κ² μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅λ κ°μ²΄λ¥Ό μ¤ν”„λ§ λΉμ΄λΌ ν•λ‹¤.
- μ¤ν”„λ§ λΉμ€ `@Bean` μ΄ λ¶™μ€ **λ©”μ„λ“ λ…**μ„ μ¤ν”„λ§ λΉμ μ΄λ¦„μΌλ΅ μ‚¬μ©ν•λ‹¤.
- μ΄λ¬ν• μ¤ν”„λ§ λΉμ€ `applicationContext.getBean(β€λΉμ΄λ¦„β€)` λ©”μ„λ“λ΅ μ‚¬μ©ν•  μ μλ‹¤.
- κΈ°μ΅΄μ—λ” κ°λ°μκ°€ μ§μ ‘ μλ°”μ½”λ“λ΅ λ¨λ“  κ²ƒμ„ ν–λ‹¤λ©΄ μ΄μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— κ°μ²΄λ¥Ό μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•κ³ , μ¤ν”„λ§ μ»¨ν…μ΄λ„μ—μ„ μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ‚¬μ©ν•λ„λ΅ λ³€κ²½λμ—λ‹¤.